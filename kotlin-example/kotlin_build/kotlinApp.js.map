{"version":3,"file":"kotlinApp.js","sources":["../src/kotlin/App.kt","../src/kotlin/common/PIXI.kt","../src/kotlin/common/Rx.kt","../src/kotlin/main.kt"],"sourcesContent":["import common.moveTo\nimport modules.PIXI\nimport modules.Rx\nimport kotlin.browser.window\n\nopen class App(options: dynamic = null) : PIXI.Application(options) {\n\n    fun timer(duration: Double): Rx.Observable<Double> {\n        lateinit var action: (Double) -> Unit\n        var count = 0.0\n        return Rx.Observable\n                .create<Double> { e ->\n                    action = { delta ->\n                        e.next(delta)\n                        count += delta\n                        if (count >= duration) {\n                            e.complete()\n                        }\n                    }\n                    ticker.add(action)\n                }\n                .finally {\n                    ticker.remove(action)\n                }\n    }\n\n    companion object : App() {\n        init {\n            resize()\n        }\n\n        fun resize() {\n            renderer.resize(window.outerWidth, window.outerHeight)\n        }\n\n        fun bootstrap() {\n            loader.add(\"cat\", \"/src/res/cat.png\")\n                    .load {\n                        val catTexture = loader.resources.cat.texture\n                        val cat = PIXI.Sprite(catTexture)\n                        cat.position.set(300, 300)\n                        stage.addChild(cat)\n                        cat.moveTo(0, 0, 100.0)\n                                .subscribe {\n                                    cat.alpha -= 0.005\n                                }\n                    }\n        }\n    }\n}\n","package common\n\nimport modules.PIXI\nimport modules.Rx\n\nfun PIXI.DisplayObject.moveTo(targetX: Int, targetY: Int, duration: Double): Rx.Observable<Double> {\n    val speedX = (targetX - x) / duration\n    val speedY = (targetY - y) / duration\n    return App.timer(duration)\n            .doOnNext { deltaTime: Double ->\n                this.x += speedX.times(deltaTime).toInt()\n                this.y += speedY.times(deltaTime).toInt()\n            }\n            .doOnComplete {\n                this.x = targetX\n                this.y = targetY\n            }\n}","package common\n\nimport modules.Rx\n\nfun <T> Rx.Observable<T>.doOnError(onError: (Throwable) -> Unit): Rx.Observable<T> {\n    return `do`({}, onError, {})\n}\n\nfun <T> Rx.Observable<T>.doOnComplete(onComplete: () -> Unit): Rx.Observable<T> {\n    return `do`({}, {}, onComplete)\n}","import kotlin.browser.document\nimport kotlin.browser.window\n\nfun main(args: Array<String>) {\n    document.body ?.appendChild(App.view)\n    window.addEventListener(\"resize\", { App.resize() })\n    App.bootstrap()\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;IA0BI,2B;IArBW,uB;MAAA,UAAmB,I;IAAQ,4BAAiB,OAAjB,C;EAA5B,C;;IAOe,wB;MACL,SAAE,MAAK,KAAL,C;MACF,mBAAS,K;MACT,IAAI,mBAAS,gBAAb,C;QACI,SAAE,W;;MAEV,W;IANS,C;EAAA,C;;IADG,oB;MACZ,mBAAS,2D;MAOT,eAAO,KAAI,iEAAJ,C;MACX,W;IATgB,C;EAAA,C;;IAUP,mB;MACL,eAAO,QAAO,iEAAP,C;MACX,W;IAFS,C;EAAA,C;;IAbjB,sB;IACA,gBAAY,GAAZ,C;IACA,OACS,+BAAe,+CAAf,CAUA,SAAQ,gCAAR,C;EAGb,C;;IAEA,6B;IAAmB,c;IAEX,a;EAFR,C;;IAMQ,aAAS,QAAO,MAAO,WAAd,EAA0B,MAAO,YAAjC,C;EACb,C;;IAUmC,qB;MACP,oBAAA,WAAI,MAAJ,GAAa,K;MACjB,W;IAFW,C;EAAA,C;;IANjB,mB;MACF,iBAAiB,gBAAO,UAAU,IAAI,Q;MACtC,UAAe,gBAAO,UAAP,C;MACf,GAAI,SAAS,KAAI,GAAJ,EAAS,GAAT,C;MACb,eAAM,UAAS,GAAT,C;MACF,OAAJ,GAAI,EAAO,CAAP,EAAU,CAAV,EAAa,KAAb,CACK,WAAU,0CAAV,C;MAGb,W;IATM,C;EAAA,C;;IADd,WAAO,KAAI,KAAJ,EAAW,kBAAX,CACE,MAAK,oCAAL,C;EAUb,C;;;;;;;;IArBJ,oC;MAAA,mB;;IAAA,6B;EAAA,C;;;;;;;ICjBkB,4B;MACN,gBAAA,WAAK,EAAL,GAAkC,YAAxB,cAAO,GAAM,SAAW,CAAlC,I;MACA,gBAAA,WAAK,EAAL,GAAkC,YAAxB,cAAO,GAAM,SAAW,CAAlC,I;MACJ,W;IAHU,C;EAAA,C;;IAII,mB;MACV,gBAAS,e;MACT,gBAAS,e;MACb,W;IAHc,C;EAAA,C;;IAPtB,aAAa,CAAC,UAAU,WAAV,IAAD,IAAgB,Q;IAC7B,aAAa,CAAC,UAAU,WAAV,IAAD,IAAgB,Q;IAC7B,OAKS,aALF,2BAAI,eAAM,QAAN,CACF,IAAS,wCAAT,CAIA,EAAa,4CAAb,C;EAIb,C;;ICZiB,W;EAAA,C;;IAAa,W;EAAA,C;;IAA1B,OAAO,aAAK,gBAAL,EAAS,OAAT,EAAkB,kBAAlB,C;EACX,C;;IAGiB,W;EAAA,C;;IAAI,W;EAAA,C;;IAAjB,OAAO,aAAK,mBAAL,EAAS,qBAAT,EAAa,UAAb,C;EACX,C;;ICLwC,2BAAI,S;IAAS,W;EAAA,C;;IADxC,Q;IAAT,CAAS,OAAT,QAAS,KAAT,6BAA4B,2BAAI,KAAhC,Q;IACA,MAAO,kBAAiB,QAAjB,EAA2B,WAA3B,C;IACP,2BAAI,Y;EACR,C;;;;;;;;;;;;;;"}